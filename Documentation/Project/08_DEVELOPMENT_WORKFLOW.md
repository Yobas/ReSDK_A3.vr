# Процессы разработки

Руководство по процессам разработки, используемым в проекте: Git workflow, code review, работа с багами и релизный процесс.

## Git workflow

### Структура веток

Проект использует следующую структуру веток:

- **`main`** - стабильная ветка для релизов
- **`develop`** - ветка разработки, интеграция новых функций
- **`feature/*`** - ветки для новых функций
- **`bugfix/*`** - ветки для исправлений багов
- **`hotfix/*`** - ветки для срочных исправлений

### Стратегия ветвления

#### Создание feature ветки

```bash
# Начать с обновленной develop
git checkout develop
git pull origin develop

# Создать feature ветку
git checkout -b feature/my-new-feature

# Работа над функцией
# ...

# Закоммитить изменения
git add .
git commit -m "Add new feature"

# Отправить ветку
git push origin feature/my-new-feature
```

#### Создание bugfix ветки

```bash
# Начать с develop или main (в зависимости от критичности)
git checkout develop
git checkout -b bugfix/fix-bug-description

# Исправить баг
# ...

# Закоммитить
git commit -m "Fix: описание исправления"

# Отправить
git push origin bugfix/fix-bug-description
```

### Коммиты и сообщения коммитов

#### Формат сообщений коммитов

Используйте следующий формат:

```
Тип: Краткое описание

Подробное описание (если необходимо)
```

**Типы коммитов:**
- `Add:` - добавление новой функции
- `Fix:` - исправление бага
- `Update:` - обновление существующей функции
- `Refactor:` - рефакторинг кода
- `Docs:` - обновление документации
- `Style:` - изменение форматирования

**Примеры:**
```
Add: новый модуль Inventory

Fix: исправление ошибки загрузки модулей

Update: улучшение производительности NOEngine

Refactor: рефакторинг системы классов
```

#### Разумное разделение коммитов

Разделяйте изменения на логические коммиты:

```bash
# Хорошо - отдельные коммиты
git add module1.sqf
git commit -m "Add: новый модуль"

git add module2.sqf
git commit -m "Add: еще один модуль"

# Плохо - все в одном коммите
git add .
git commit -m "Изменения"
```

### Работа с форками и PR

#### Процесс создания Pull Request

1. **Форкните репозиторий** на GitHub
2. **Клонируйте ваш форк:**
   ```bash
   git clone https://github.com/YOUR_USERNAME/ReSDK_A3.vr.git
   ```
3. **Создайте ветку для изменений:**
   ```bash
   git checkout -b feature/my-changes
   ```
4. **Внесите изменения и закоммитьте:**
   ```bash
   git add .
   git commit -m "Add: описание изменений"
   ```
5. **Отправьте ветку:**
   ```bash
   git push origin feature/my-changes
   ```
6. **Создайте Pull Request** на GitHub

#### Описание Pull Request

Включите в описание PR:
- **Что изменено** - краткое описание изменений
- **Зачем** - причина изменений
- **Как тестировалось** - как проверялись изменения
- **Скриншоты** (если применимо)

## Code Review

### Процесс code review

1. Автор создает PR
2. Автоматические проверки запускаются
3. Ревьюеры проверяют код
4. Исправляются замечания (если есть)
5. PR одобряется и мержится

### Критерии принятия изменений

Код должен соответствовать:

- ✅ **Стандартам кодирования** - см. [CODE-STANDARDS.md](../../CODE-STANDARDS.md)
- ✅ **Архитектуре проекта** - изменения должны соответствовать архитектуре
- ✅ **Тестам** - все тесты должны проходить
- ✅ **Документации** - код должен быть документирован

### Автоматические проверки

При создании PR автоматически проверяется:

- Форматирование кода
- Наличие синтаксических ошибок
- Соответствие стандартам именования

### Тестирование перед merge

Перед мержем PR должен быть протестирован:

1. **Локальное тестирование** автором
2. **Проверка на совместимость** с существующим кодом
3. **Тестирование в редакторе** (если применимо)
4. **Тестирование на сервере** (если применимо)

## Работа с багами

### Процесс создания issue

1. **Проверьте существующие issues** - возможно, баг уже известен
2. **Создайте новый issue** на GitHub
3. **Опишите проблему:**
   - Шаги для воспроизведения
   - Ожидаемое поведение
   - Фактическое поведение
   - Версия проекта
   - Логи (если есть)

### Приоритизация багов

Багги классифицируются по приоритету:

- **Critical** - блокирует работу проекта
- **High** - серьезная проблема, требует быстрого исправления
- **Medium** - влияет на функциональность, но не блокирует
- **Low** - незначительная проблема

### Процесс исправления

1. **Создайте bugfix ветку:**
   ```bash
   git checkout -b bugfix/issue-description
   ```
2. **Исправьте баг:**
   - Напишите тест, воспроизводящий баг
   - Исправьте код
   - Убедитесь, что тест проходит
3. **Закоммитьте:**
   ```bash
   git commit -m "Fix: описание исправления"
   ```
4. **Создайте PR** и укажите номер issue

### Регрессионное тестирование

После исправления бага:

1. Проверьте, что баг исправлен
2. Убедитесь, что не сломали другую функциональность
3. Запустите все существующие тесты

## Релизный процесс

### Подготовка к релизу

1. **Убедитесь, что все изменения готовы:**
   - Все PR мержены в `develop`
   - Все тесты проходят
   - Документация обновлена

2. **Обновите версию:**
   - Откройте `Src/VERSION`
   - Обновите версию согласно семантическому версионированию
   - См. [Версионирование](07_VERSIONING.md)

3. **Создайте changelog:**
   - Документируйте все изменения
   - Группируйте по типам (Add, Fix, Update)

### Тестирование релизной версии

1. **Соберите релизную версию:**
   ```bash
   rb build -release
   ```
2. **Протестируйте:**
   - Запустите все тесты
   - Проверьте критичные функции
   - Протестируйте на тестовом сервере
3. **Исправьте найденные проблемы** (если есть)

### Создание changelog

Создайте файл `CHANGELOG.md` или обновите существующий:

```markdown
# Версия 1.9.2

## Исправления
- Исправлен баг в системе инвентаря (#123)
- Исправлена ошибка загрузки модулей (#124)

## Изменения
- Обновлен формат конфигурации
- Улучшена производительность NOEngine

## Добавлено
- Новый модуль Statistics
```

### Развертывание релиза

1. **Создайте тег:**
   ```bash
   git tag -a v1.9.2 -m "Release version 1.9.2"
   git push origin v1.9.2
   ```

2. **Мердж в main:**
   ```bash
   git checkout main
   git merge develop
   git push origin main
   ```

3. **Создайте релиз на GitHub:**
   - Перейдите на страницу релизов
   - Создайте новый релиз
   - Приложите changelog
   - Прикрепите артефакты сборки (если необходимо)

4. **Разверните на серверах:**
   - Соберите релизную версию
   - Разверните на продакшн серверах
   - Мониторьте логи на ошибки

## Работа с конфликтами

### Разрешение конфликтов при merge

```bash
# Обновите вашу ветку
git checkout develop
git pull origin develop

# Мердж в вашу ветку
git checkout feature/my-feature
git merge develop

# Разрешите конфликты в файлах
# ...

# Закоммитьте разрешение
git add .
git commit -m "Resolve merge conflicts"
```

### Разрешение конфликтов в PR

1. GitHub покажет конфликты в интерфейсе
2. Разрешите конфликты в интерфейсе или локально
3. Закоммитьте разрешение

## Лучшие практики

### Регулярные обновления

```bash
# Регулярно обновляйте вашу ветку из develop
git checkout develop
git pull origin develop
git checkout feature/my-feature
git merge develop
```

### Мелкие коммиты

Делайте мелкие, логические коммиты вместо больших:

```bash
# Хорошо
git commit -m "Add: функция A"
git commit -m "Add: функция B"

# Плохо
git commit -m "Все изменения"
```

### Комментарии в коде

Используйте комментарии для объяснения сложной логики:

```sqf
// Вычисляем расстояние с учетом кривизны поверхности
private _distance = [/* сложная формула */] call calculateDistance;
```

## Что дальше?

- ➡️ [Стандарты кодирования](09_CODING_STANDARDS.md) - правила написания кода
- ➡️ [Версионирование](07_VERSIONING.md) - процесс создания релизов

